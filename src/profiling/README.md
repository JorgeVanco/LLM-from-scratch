## Simple Benchmarking

```bash
uv run -m src.profiling.benchmark --warmup_steps 5
```

|    |   d_model |   d_ff |   num_heads |   num_layers |   warmup_steps |   benchmark_steps |   mean_time_forward |   std_time_forward |   mean_time_backward |   std_time_backward |
|---:|----------:|-------:|------------:|-------------:|---------------:|------------------:|--------------------:|-------------------:|---------------------:|--------------------:|
|  0 |       768 |   3072 |          12 |           12 |              5 |                10 |           0.0110926 |        0.00144936  |            0.0237466 |         0.0246742   |
|  1 |      1024 |   4096 |          16 |           24 |              5 |                10 |           0.030557  |        0.0172333   |            0.0365372 |         0.000991252 |
|  2 |      1280 |   5120 |          20 |           36 |              5 |                10 |           0.0470031 |        0.00416827  |            0.0911177 |         0.0285251   |
|  3 |      1600 |   6400 |          25 |           48 |              5 |                10 |           0.0770837 |        0.000741432 |            0.146888  |         0.00055198  |
|  4 |      2560 |  10240 |          32 |           32 |              5 |                10 |           0.0940117 |        0.000374099 |            0.213428  |         0.000346275 |
|  5 |       768 |   3072 |          12 |           12 |              0 |                10 |           0.0683708 |        0.171854    |            0.025049  |         0.0290173   |
|  6 |      1024 |   4096 |          16 |           24 |              0 |                10 |           0.0425699 |        0.0486649   |            0.036466  |         0.000734291 |
|  7 |      1280 |   5120 |          20 |           36 |              0 |                10 |           0.0460283 |        0.00135309  |            0.0807268 |         0.000305661 |
|  8 |      1600 |   6400 |          25 |           48 |              0 |                10 |           0.0782877 |        0.00323167  |            0.158516  |         0.0279449   |
|  9 |      2560 |  10240 |          32 |           32 |              0 |                10 |           0.0940631 |        0.000444747 |            0.231932  |         0.0560847   |
| 10 |       768 |   3072 |          12 |           12 |              1 |                10 |           0.0110475 |        0.00142442  |            0.0231272 |         0.0233507   |
| 11 |      1024 |   4096 |          16 |           24 |              1 |                10 |           0.0252342 |        0.00329229  |            0.0362106 |         0.000246615 |
| 12 |      1280 |   5120 |          20 |           36 |              1 |                10 |           0.0459393 |        0.00103583  |            0.100875  |         0.0598615   |
| 13 |      1600 |   6400 |          25 |           48 |              1 |                10 |           0.0773202 |        0.000428324 |            0.15631   |         0.0276363   |
| 14 |      2560 |  10240 |          32 |           32 |              1 |                10 |           0.0941961 |        0.000476703 |            0.216184  |         0.00771894  |


## Nsight Systems Profiler

```bash
uv run nsys profile -o result --force-overwrite true python -m src.profiling.benchmark
```

## Attention Benchmarking

|    |   d_head |   seq_len |   forward_mean |   forward_std |   backward_mean |   backward_std |   max_memory (MiB) |
|---:|---------:|----------:|---------------:|--------------:|----------------:|---------------:|-------------------:|
|  0 |       16 |       256 |    0.000150909 |   1.39879e-05 |     0.00198871  |    0.0125478   |            44.8438 |
|  1 |       16 |      1024 |    0.000253594 |   2.63546e-06 |     0.000894634 |    0.000103788 |           268.454  |
|  2 |       16 |      4096 |    0.00269196  |   3.47825e-06 |     0.00741294  |    6.01559e-05 |          3294.56   |
|  3 |       16 |      8192 |    0.0152145   |   0.00685151  |     0.0360429   |    0.0519943   |         14129.3    |
|  4 |       16 |     16384 |    0.0466721   |   0.0148125   |     0.129156    |    0.0497277   |         56258.5    |
|  5 |       32 |       256 |    0.000148759 |   7.67491e-06 |     0.000669453 |    0.000172003 |         24958.5    |
|  6 |       32 |      1024 |    0.000263117 |   2.72729e-06 |     0.000895173 |    9.4947e-05  |           271.704  |
|  7 |       32 |      4096 |    0.00320353  |   0.00105491  |     0.0084485   |    0.00187631  |          3307.56   |
|  8 |       32 |      8192 |    0.0123047   |   0.00272519  |     0.0332919   |    0.0116683   |         14161.3    |
|  9 |       32 |     16384 |    0.0463537   |   0.00684151  |     0.126917    |    0.043195    |         56322.5    |
| 10 |       64 |       256 |    0.000147324 |   5.2417e-06  |     0.000688789 |    0.000175775 |         25007.7    |
| 11 |       64 |      1024 |    0.000283949 |   2.62811e-06 |     0.000916825 |    0.000102215 |           278.204  |
| 12 |       64 |      4096 |    0.00306845  |   4.96341e-06 |     0.0124821   |    0.0047594   |          3333.56   |
| 13 |       64 |      8192 |    0.012167    |   2.19967e-05 |     0.0340277   |    0.00432556  |         14225.3    |
| 14 |       64 |     16384 |    0.0549976   |   0.0157115   |     0.137576    |    0.0343985   |         56450.5    |
| 15 |      128 |       256 |    0.00024903  |   0.00035876  |     0.00083551  |    0.000743987 |         25106.2    |
| 16 |      128 |      1024 |    0.000324841 |   2.03475e-06 |     0.0010666   |    0.000331804 |           291.204  |
| 17 |      128 |      4096 |    0.0040285   |   0.00092883  |     0.00927519  |    3.64413e-05 |          3385.56   |
| 18 |      128 |      8192 |    0.0211987   |   0.00939514  |     0.0370378   |    0.00355447  |         14353.3    |
| 19 |      128 |     16384 |    0.064465    |   0.017187    |     0.156941    |    0.0365732   |         56706.5    |