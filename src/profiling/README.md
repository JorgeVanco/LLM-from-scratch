## Simple Benchmarking

```bash
uv run -m src.profiling.benchmark --warmup_steps 5
```

|    |   d_model |   d_ff |   num_heads |   num_layers |   warmup_steps |   benchmark_steps |   mean_time_forward |   std_time_forward |   mean_time_backward |   std_time_backward |
|---:|----------:|-------:|------------:|-------------:|---------------:|------------------:|--------------------:|-------------------:|---------------------:|--------------------:|
|  0 |       768 |   3072 |          12 |           12 |              5 |                10 |           0.0110926 |        0.00144936  |            0.0237466 |         0.0246742   |
|  1 |      1024 |   4096 |          16 |           24 |              5 |                10 |           0.030557  |        0.0172333   |            0.0365372 |         0.000991252 |
|  2 |      1280 |   5120 |          20 |           36 |              5 |                10 |           0.0470031 |        0.00416827  |            0.0911177 |         0.0285251   |
|  3 |      1600 |   6400 |          25 |           48 |              5 |                10 |           0.0770837 |        0.000741432 |            0.146888  |         0.00055198  |
|  4 |      2560 |  10240 |          32 |           32 |              5 |                10 |           0.0940117 |        0.000374099 |            0.213428  |         0.000346275 |
|  5 |       768 |   3072 |          12 |           12 |              0 |                10 |           0.0683708 |        0.171854    |            0.025049  |         0.0290173   |
|  6 |      1024 |   4096 |          16 |           24 |              0 |                10 |           0.0425699 |        0.0486649   |            0.036466  |         0.000734291 |
|  7 |      1280 |   5120 |          20 |           36 |              0 |                10 |           0.0460283 |        0.00135309  |            0.0807268 |         0.000305661 |
|  8 |      1600 |   6400 |          25 |           48 |              0 |                10 |           0.0782877 |        0.00323167  |            0.158516  |         0.0279449   |
|  9 |      2560 |  10240 |          32 |           32 |              0 |                10 |           0.0940631 |        0.000444747 |            0.231932  |         0.0560847   |
| 10 |       768 |   3072 |          12 |           12 |              1 |                10 |           0.0110475 |        0.00142442  |            0.0231272 |         0.0233507   |
| 11 |      1024 |   4096 |          16 |           24 |              1 |                10 |           0.0252342 |        0.00329229  |            0.0362106 |         0.000246615 |
| 12 |      1280 |   5120 |          20 |           36 |              1 |                10 |           0.0459393 |        0.00103583  |            0.100875  |         0.0598615   |
| 13 |      1600 |   6400 |          25 |           48 |              1 |                10 |           0.0773202 |        0.000428324 |            0.15631   |         0.0276363   |
| 14 |      2560 |  10240 |          32 |           32 |              1 |                10 |           0.0941961 |        0.000476703 |            0.216184  |         0.00771894  |


## Nsight Systems Profiler

```bash
uv run nsys profile -o result --force-overwrite true python -m src.profiling.benchmark
```